- Question 0
CREATE VIEW q0(era)
AS
  SELECT MAX(era)
  FROM pitching;

-- Question 1i
CREATE VIEW q1i(namefirst, namelast, birthyear)
AS
  SELECT namefirst, namelast, birthyear
        WHERE weight > 300;

-- Question 1ii
CREATE VIEW q1ii(namefirst, namelast, birthyear)
AS
  SELECT SELECT namefirst, namelast, birthyear 
        FROM people 
        WHERE namefirst LIKE '% %';


-- Question 1iii
CREATE VIEW q1iii(birthyear, avgheight, count)
AS
  SELECT birthyear, AVG(height), COUNT(birthyear) 
        FROM people 
        GROUP BY birthyear 
        ORDER BY birthyear

;

-- Question 1iv
CREATE VIEW q1iv(birthyear, avgheight, count)
AS
  SELECT birthyear, AVG(height), COUNT(birthyear)
        FROM people
        GROUP BY birthyear
        HAVING COUNT(height) > 70 ORDER BY birthyear
;

-- Question 2i
CREATE VIEW q2i(namefirst, namelast, playerid, yearid)
AS
   SELECT p.namefirst, p.namelast, s.playerid, s.yearid 
        FROM people AS p INNER JOIN halloffame AS s ON
        p.playerid = s.playerid 
        WHERE s.inducted = 'Y' 
        ORDER BY s.yearid DESC
;
-- Question 2ii
CREATE VIEW q2ii(namefirst, namelast, playerid, schoolid, yearid)
AS
   	
  SELECT DISTINCT p.namefirst, p.namelast, s.playerid,c.schoolid, s.yearid
        FROM collegeplaying AS c, people AS p INNER JOIN halloffame AS s ON
        p.playerid = s.playerid
        WHERE s.inducted = 'Y' AND c.playerid = p.playerid
        AND p.playerid IN ( SELECT c.playerid FROM collegeplaying AS c INNER JOIN schools AS sc ON 		c.schoolid = sc.schoolid WHERE sc.schoolstate LIKE '%CA%') 
			ORDER BY  s.yearid DESC;

-- Question 2iii
CREATE VIEW q2iii(playerid, namefirst, namelast, schoolid)
AS
 SELECT p.playerid, p.namefirst, p.namelast, c.schoolid
    	FROM collegeplaying AS c RIGHT OUTER JOIN people AS p ON
  	  	p.playerid = c.playerid 
	  	WHERE p.playerid IN  (SELECT p.playerid FROM people AS p INNER JOIN halloffame AS s ON
        p.playerid = s.playerid
        WHERE s.inducted = 'Y')
			ORDER BY p.playerid, c.schoolid ASC ;
;




